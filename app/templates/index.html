{% extends "bootstrap/base.html" %}
{% block title %}Home{% endblock %}
{% block script %}
    <script type=text/javascript src="{{ url_for('static', filename='js/jquery-3.3.1.min.js') }}"></script>
{% endblock script %}
{% block navbar %}
    <nav class="navbar navbar-light bg-light">
        <a class="navbar-brand" href="#">
            Dublin Bike Station
            {#                <img src="{{url_for('.static', filename='')}}" width="100" height="100" class="d-inline-block align-top" alt="">#}
        </a>
    </nav>
{% endblock navbar %}

{% block content %}
    <div class="input-group mb-3" style="width: 30%">
        <input id="search_box" type="text" class="form-control" placeholder="Station name, Street name..."
               aria-label="Recipient's username"
               aria-describedby="button-addon2">
        <div class="input-group-append">
            <button class="btn btn-outline-secondary" type="button" id="button-addon2">Search</button>
        </div>
    </div>
    <div id="hint"></div>
    <div id="bike_map" style="width:70%;height:600px;"></div>
    <div id="weather_box">{{ weather_json["weather"][0]["main"] }}-{{ weather_json["main"]["temp"] }}</div>
    <h3 id="test"></h3>
    <script>
        var delay = (function () {
            var timer = 0;
            return function (callback, ms) {
                clearTimeout(timer);
                timer = setTimeout(callback, ms);
            };
        })();
        $('#search_box').keyup(function () {
            delay(function () {
                var input = $("#search_box").val();
                $.get("/search", {'input': input}, function (data) {
                    let hint_msg = "<ul>";
                    Object.keys(data).forEach(function (key) {
                        hint_msg+="<li>"+data[key]+"</li>"
                    });
                    hint_msg+="</ul>";
                    $("#hint").html(hint_msg);
                });
            }, 0);
        });
    </script>
    <script type="text/javascript" id="map_script" src="{{ url_for('static', filename='js/map.js') }}"
            data="{{ bike_api_key }}"></script>
    <script async defer
            src= {{ map_key }}>
    </script>

{% endblock %}

